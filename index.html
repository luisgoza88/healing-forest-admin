<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Healing Forest Admin</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <style>
      :root {
        --event-available: #16a34a;
        --event-full: #f59e0b;
        --event-canceled: #dc2626;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #f5f5f5;
        color: #333;
      }

      .event-available {
        background-color: var(--event-available) !important;
        border-color: var(--event-available) !important;
      }

      .event-full {
        background-color: var(--event-full) !important;
        border-color: var(--event-full) !important;
      }

      .event-canceled {
        background-color: var(--event-canceled) !important;
        border-color: var(--event-canceled) !important;
        text-decoration: line-through;
      }

      /* Login Screen */
      .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
      }

      .login-box {
        background: white;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 400px;
      }

      .login-box h1 {
        text-align: center;
        color: #1e3a3f;
        margin-bottom: 30px;
        font-size: 28px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #666;
        font-weight: 500;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
        transition: border 0.3s;
      }

      .form-group input:focus {
        outline: none;
        border-color: #16a34a;
      }

      .btn {
        width: 100%;
        padding: 14px;
        background: #16a34a;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.3s;
      }

      .btn:hover {
        background: #15803d;
      }

      .error-message {
        background: #fee;
        color: #c33;
        padding: 12px;
        border-radius: 6px;
        margin-top: 20px;
        text-align: center;
        display: none;
      }

      /* Dashboard */
      .dashboard {
        display: none;
        min-height: 100vh;
      }

      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: 250px;
        height: 100vh;
        background: #1e3a3f;
        color: white;
        padding: 20px;
        overflow-y: auto;
      }

      .sidebar h2 {
        margin-bottom: 30px;
        font-size: 24px;
        text-align: center;
      }

      .nav-item {
        display: block;
        padding: 15px 20px;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        margin-bottom: 10px;
        transition: background 0.3s;
        cursor: pointer;
      }

      .nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .nav-item.active {
        background: #16a34a;
      }

      .main-content {
        margin-left: 250px;
        padding: 20px;
      }

      .header {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header h1 {
        color: #1e3a3f;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .logout-btn {
        padding: 8px 16px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }

      .logout-btn:hover {
        background: #c82333;
      }

      /* Stats Cards */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .stat-card h3 {
        color: #666;
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 10px;
      }

      .stat-card .value {
        font-size: 32px;
        font-weight: 700;
        color: #16a34a;
      }

      /* Content Sections */
      .content-section {
        display: none;
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .content-section.active {
        display: block;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
      }

      .section-header h2 {
        color: #1e3a3f;
      }

      .add-btn {
        padding: 10px 20px;
        background: #16a34a;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
      }

      .add-btn:hover {
        background: #15803d;
      }

      /* Tables */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      th {
        background: #f8f9fa;
        padding: 12px;
        text-align: left;
        font-weight: 600;
        color: #666;
        border-bottom: 2px solid #dee2e6;
      }

      td {
        padding: 12px;
        border-bottom: 1px solid #dee2e6;
      }

      tr:hover {
        background: #f8f9fa;
      }

      .action-btn {
        padding: 6px 12px;
        margin: 0 2px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
      }

      .edit-btn {
        background: #ffc107;
        color: #000;
      }

      .delete-btn {
        background: #dc3545;
        color: white;
      }

      /* Loading */
      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal.active {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 30px;
        border-radius: 8px;
        width: 90%;
        max-width: 500px;
      }

      /* Calendar Modal */
      .calendar-modal .modal-content {
        max-width: 1200px;
        width: 95%;
        height: 90vh;
        max-height: 900px;
        padding: 20px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .calendar-container {
        flex: 1;
        overflow: auto;
        margin-top: 20px;
      }

      /* Service availability indicators */
      .availability-dot {
        display: inline-block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 5px;
      }

      .availability-dot.available {
        background-color: #16a34a;
      }

      .availability-dot.almost-full {
        background-color: #f59e0b;
      }

      .availability-dot.full {
        background-color: #dc2626;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .close-btn {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #666;
      }

      /* Report buttons */
      .report-btn {
        background: white;
        border: 2px solid #16a34a;
        color: #16a34a;
        padding: 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16;
        font-weight: 500;
        transition: all 0.3s;
        text-align: center;
      }

      .report-btn:hover {
        background: #16a34a;
        color: white;
      }

      /* Payment status badges */
      .badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
      }

      .badge.pagado {
        background: #d4edda;
        color: #155724;
      }

      .badge.pendiente {
        background: #fff3cd;
        color: #856404;
      }

      .badge.cancelado {
        background: #f8d7da;
        color: #721c24;
      }

      /* Category tabs */
      .category-tab {
        padding: 8px 16px;
        margin-right: 5px;
        border: 1px solid #ddd;
        background: white;
        color: #666;
        cursor: pointer;
        border-radius: 4px 4px 0 0;
        border-bottom: none;
        transition: all 0.3s;
      }

      .category-tab:hover {
        background: #f8f9fa;
      }

      .category-tab.active {
        background: #16a34a;
        color: white;
        border-color: #16a34a;
      }

      /* Stock status badges */
      .stock-ok {
        color: #16a34a;
        font-weight: 600;
      }

      .stock-low {
        color: #f59e0b;
        font-weight: 600;
      }

      .stock-out {
        color: #ef4444;
        font-weight: 600;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      /* Service calendar styles */
      .fc-event {
        cursor: pointer;
        transition: all 0.2s;
      }

      .fc-event:hover {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      /* Capacity indicator styles */
      .capacity-full {
        background-color: #dc2626 !important;
        border-color: #991b1b !important;
      }

      .capacity-almost-full {
        background-color: #f59e0b !important;
        border-color: #d97706 !important;
      }

      .capacity-available {
        background-color: #16a34a !important;
        border-color: #15803d !important;
      }

      /* Service availability card hover */
      #serviceAvailabilityGrid > div:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: all 0.2s;
      }

      /* Loading spinner animation */
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          width: 200px;
        }

        .main-content {
          margin-left: 200px;
        }

        .form-row {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 600px) {
        .sidebar {
          width: 100%;
          height: auto;
          position: static;
        }

        .main-content {
          margin-left: 0;
        }
      }
    </style>
  </head>
  <body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
      <div class="login-box">
        <h1>🌳 Healing Forest Admin</h1>
        <p style="font-size: 12px; color: #666; text-align: center">
          Versión actualizada: 5 Agosto 2025 - Con Deploy Automático ✅
        </p>
        <form id="loginForm">
          <div class="form-group">
            <label for="email">Correo Electrónico</label>
            <input
              type="email"
              id="email"
              placeholder="admin@healingforest.com"
              required
            />
          </div>
          <div class="form-group">
            <label for="password">Contraseña</label>
            <input
              type="password"
              id="password"
              placeholder="Contraseña"
              required
            />
          </div>
          <button type="submit" class="btn">Iniciar Sesión</button>
        </form>
        <div class="error-message" id="errorMessage"></div>
      </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
      <div class="sidebar">
        <h2>🌳 Admin Panel</h2>
        <nav>
          <a class="nav-item active" data-section="overview">Dashboard</a>
          <a class="nav-item" data-section="appointments">Citas</a>
          <a class="nav-item" data-section="staff">Personal</a>
          <a class="nav-item" data-section="patients">Pacientes</a>
          <a class="nav-item" data-section="services">Servicios</a>
          <a class="nav-item" data-section="inventory">Inventario</a>
          <a class="nav-item" data-section="payments">Pagos</a>
          <a class="nav-item" data-section="reports">Reportes</a>
          <a class="nav-item" data-section="sop">S&OP Planning</a>
          <a class="nav-item" data-section="integrations">Integraciones</a>
          <a class="nav-item" data-section="whatsapp">WhatsApp</a>
          <a class="nav-item" data-section="notifications">Notificaciones</a>
          <a class="nav-item" data-section="settings">Configuración</a>
        </nav>
      </div>

      <div class="main-content">
        <div class="header">
          <h1 id="pageTitle">Dashboard</h1>
          <div class="user-info">
            <span id="userEmail"></span>
            <button class="logout-btn" onclick="logout()">Cerrar Sesión</button>
          </div>
        </div>

        <!-- Overview Section -->
        <div class="content-section active" id="overview">
          <div class="stats-grid">
            <div class="stat-card">
              <h3>Citas Hoy</h3>
              <div class="value" id="todayAppointments">0</div>
            </div>
            <div class="stat-card">
              <h3>Pacientes Totales</h3>
              <div class="value" id="totalPatients">0</div>
            </div>
            <div class="stat-card">
              <h3>Personal Activo</h3>
              <div class="value" id="activeStaff">0</div>
            </div>
            <div class="stat-card">
              <h3>Servicios</h3>
              <div class="value" id="totalServices">0</div>
            </div>
          </div>

          <!-- Charts Section -->
          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 20px;
              margin: 40px 0;
            "
          >
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <h3 style="margin-bottom: 20px">Citas por Día (Última Semana)</h3>
              <canvas id="appointmentsChart"></canvas>
            </div>
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <h3 style="margin-bottom: 20px">Servicios Más Solicitados</h3>
              <canvas id="servicesChart"></canvas>
            </div>
          </div>

          <!-- Service Availability Summary -->
          <div style="margin-top: 40px; margin-bottom: 30px">
            <h2 style="margin-bottom: 20px">Disponibilidad de Servicios Hoy</h2>
            <div
              id="serviceAvailabilityGrid"
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
              "
            >
              <!-- Service availability cards will be loaded here -->
            </div>
          </div>

          <h2 style="margin-top: 40px; margin-bottom: 20px">Citas de Hoy</h2>
          <table id="todayAppointmentsTable">
            <thead>
              <tr>
                <th>Hora</th>
                <th>Paciente</th>
                <th>Servicio</th>
                <th>Profesional</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="loading">Cargando citas...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Appointments Section -->
        <div class="content-section" id="appointments">
          <div class="section-header">
            <h2>Gestión de Citas</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportTableToExcel('appointmentsTable', 'citas')"
              >
                📥 Exportar Excel
              </button>
              <button
                class="add-btn"
                style="margin-right: 10px"
                onclick="toggleCalendarView()"
              >
                <span id="viewToggleText">Ver Calendario</span>
              </button>
              <button class="add-btn" onclick="showAddAppointment()">
                + Nueva Cita
              </button>
            </div>
          </div>

          <!-- Calendar View -->
          <div id="calendarView" style="display: none; margin-bottom: 30px">
            <div id="calendar"></div>
          </div>

          <!-- Table View -->
          <div id="tableView">
            <table id="appointmentsTable">
              <thead>
                <tr>
                  <th>Fecha</th>
                  <th>Hora</th>
                  <th>Paciente</th>
                  <th>Servicio</th>
                  <th>Profesional</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="7" class="loading">Cargando citas...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Staff Section -->
        <div class="content-section" id="staff">
          <div class="section-header">
            <h2>Gestión de Personal</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportTableToExcel('staffTable', 'personal')"
              >
                📥 Exportar Excel
              </button>
              <button class="add-btn" onclick="showAddStaff()">
                + Nuevo Personal
              </button>
            </div>
          </div>
          <table id="staffTable">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Rol</th>
                <th>Especialidades</th>
                <th>Email</th>
                <th>Teléfono</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="loading">Cargando personal...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Patients Section -->
        <div class="content-section" id="patients">
          <div class="section-header">
            <h2>Gestión de Pacientes</h2>
            <div>
              <button
                class="add-btn"
                style="background: #0ea5e9"
                onclick="exportTableToExcel('patientsTable', 'pacientes')"
              >
                📥 Exportar Excel
              </button>
            </div>
          </div>
          <table id="patientsTable">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Email</th>
                <th>Teléfono</th>
                <th>Fecha Nacimiento</th>
                <th>Género</th>
                <th>Citas</th>
                <th>Última Visita</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="8" class="loading">Cargando pacientes...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Services Section -->
        <div class="content-section" id="services">
          <div class="section-header">
            <h2>Gestión de Servicios</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportTableToExcel('servicesTable', 'servicios')"
              >
                📥 Exportar Excel
              </button>
              <button class="add-btn" onclick="showAddService()">
                + Nuevo Servicio
              </button>
            </div>
          </div>
          <table id="servicesTable">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Categoría</th>
                <th>Duración</th>
                <th>Precio</th>
                <th>Estado / Capacidad</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="6" class="loading">Cargando servicios...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Inventory Section -->
        <div class="content-section" id="inventory">
          <div class="section-header">
            <h2>Gestión de Inventario</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #ef4444"
                onclick="showLowStockAlert()"
              >
                ⚠️ Stock Bajo
              </button>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportTableToExcel('inventoryTable', 'inventario')"
              >
                📥 Exportar Excel
              </button>
              <button class="add-btn" onclick="showAddProduct()">
                + Nuevo Producto
              </button>
            </div>
          </div>

          <!-- Inventory Stats -->
          <div class="stats-grid" style="margin-bottom: 30px">
            <div class="stat-card">
              <h3>Total Productos</h3>
              <div class="value" id="totalProducts">0</div>
            </div>
            <div class="stat-card">
              <h3>Valor Total</h3>
              <div class="value" id="totalInventoryValue">$0</div>
            </div>
            <div class="stat-card">
              <h3>Productos con Stock Bajo</h3>
              <div class="value" id="lowStockCount" style="color: #ef4444">
                0
              </div>
            </div>
            <div class="stat-card">
              <h3>Último Movimiento</h3>
              <div class="value" id="lastMovement" style="font-size: 16px">
                -
              </div>
            </div>
          </div>

          <!-- Category Tabs -->
          <div style="margin-bottom: 20px">
            <button
              class="category-tab active"
              onclick="filterByCategory('all')"
            >
              Todos
            </button>
            <button
              class="category-tab"
              onclick="filterByCategory('medicamentos')"
            >
              Medicamentos
            </button>
            <button
              class="category-tab"
              onclick="filterByCategory('suplementos')"
            >
              Suplementos
            </button>
            <button class="category-tab" onclick="filterByCategory('equipos')">
              Equipos
            </button>
            <button
              class="category-tab"
              onclick="filterByCategory('consumibles')"
            >
              Consumibles
            </button>
            <button class="category-tab" onclick="filterByCategory('otros')">
              Otros
            </button>
          </div>

          <!-- Inventory Table -->
          <table id="inventoryTable">
            <thead>
              <tr>
                <th>Código</th>
                <th>Nombre</th>
                <th>Categoría</th>
                <th>Stock Actual</th>
                <th>Stock Mínimo</th>
                <th>Precio Unit.</th>
                <th>Valor Total</th>
                <th>Cód. Barras</th>
                <th>Vencimiento</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="9" class="loading">Cargando productos...</td>
              </tr>
            </tbody>
          </table>

          <!-- Movement History -->
          <div style="margin-top: 40px">
            <h3 style="margin-bottom: 20px">Historial de Movimientos</h3>
            <table id="movementsTable">
              <thead>
                <tr>
                  <th>Fecha</th>
                  <th>Producto</th>
                  <th>Tipo</th>
                  <th>Cantidad</th>
                  <th>Responsable</th>
                  <th>Notas</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="loading">Cargando movimientos...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Payments Section -->
        <div class="content-section" id="payments">
          <div class="section-header">
            <h2>Gestión de Pagos</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportTableToExcel('paymentsTable', 'pagos')"
              >
                📥 Exportar Excel
              </button>
              <button class="add-btn" onclick="showAddPayment()">
                + Registrar Pago
              </button>
            </div>
          </div>
          <div class="stats-grid" style="margin-bottom: 30px">
            <div class="stat-card">
              <h3>Ingresos del Mes</h3>
              <div class="value" id="monthlyIncome">$0</div>
            </div>
            <div class="stat-card">
              <h3>Pagos Pendientes</h3>
              <div class="value" id="pendingPayments">0</div>
            </div>
            <div class="stat-card">
              <h3>Pagos Hoy</h3>
              <div class="value" id="todayPayments">$0</div>
            </div>
          </div>
          <table id="paymentsTable">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Paciente</th>
                <th>Servicio</th>
                <th>Monto</th>
                <th>Método</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="loading">Cargando pagos...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Reports Section -->
        <div class="content-section" id="reports">
          <div class="section-header">
            <h2>Reportes y Análisis</h2>
          </div>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
              gap: 20px;
              margin-bottom: 30px;
            "
          >
            <button class="report-btn" onclick="generateReport('appointments')">
              📅 Reporte de Citas
            </button>
            <button class="report-btn" onclick="generateReport('income')">
              💰 Reporte de Ingresos
            </button>
            <button class="report-btn" onclick="generateReport('patients')">
              👥 Reporte de Pacientes
            </button>
            <button class="report-btn" onclick="generateReport('services')">
              🏥 Reporte de Servicios
            </button>
          </div>
          <div
            id="reportPreview"
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              margin-top: 20px;
              display: none;
            "
          >
            <h3>Vista Previa del Reporte</h3>
            <div id="reportContent"></div>
            <button
              class="btn"
              onclick="downloadReport()"
              style="margin-top: 20px"
            >
              📥 Descargar PDF
            </button>
          </div>
        </div>

        <!-- Integrations Section -->
        <div class="content-section" id="integrations">
          <div class="section-header">
            <h2>Integraciones con Sistemas Externos</h2>
          </div>

          <!-- Integration Cards -->
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
              gap: 20px;
              margin-bottom: 30px;
            "
          >
            <!-- Siigo Integration -->
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <div
                style="display: flex; align-items: center; margin-bottom: 15px"
              >
                <div
                  style="
                    width: 50px;
                    height: 50px;
                    background: #ff6b35;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 15px;
                  "
                >
                  <span style="font-size: 24px; color: white">S</span>
                </div>
                <div>
                  <h3 style="margin: 0">Siigo</h3>
                  <small style="color: #666">Facturación Electrónica</small>
                </div>
              </div>
              <p style="color: #666; margin-bottom: 15px">
                Genera facturas electrónicas válidas ante la DIAN directamente
                desde el panel.
              </p>
              <div id="siigoStatus" style="margin-bottom: 15px">
                <span class="badge" style="background: #fbbf24; color: #000"
                  >No Configurado</span
                >
              </div>
              <button
                class="btn"
                style="width: 100%"
                onclick="configureSiigo()"
              >
                Configurar Siigo
              </button>
            </div>

            <!-- SaludTools Integration -->
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <div
                style="display: flex; align-items: center; margin-bottom: 15px"
              >
                <div
                  style="
                    width: 50px;
                    height: 50px;
                    background: #0ea5e9;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 15px;
                  "
                >
                  <span style="font-size: 24px; color: white">+</span>
                </div>
                <div>
                  <h3 style="margin: 0">SaludTools</h3>
                  <small style="color: #666">Gestión de Salud</small>
                </div>
              </div>
              <p style="color: #666; margin-bottom: 15px">
                Maneja RIPS, autorizaciones de EPS y cumplimiento normativo de
                salud.
              </p>
              <div id="saludtoolsStatus" style="margin-bottom: 15px">
                <span class="badge" style="background: #fbbf24; color: #000"
                  >No Configurado</span
                >
              </div>
              <button
                class="btn"
                style="width: 100%"
                onclick="configureSaludTools()"
              >
                Configurar SaludTools
              </button>
            </div>

            <!-- WhatsApp Business Integration -->
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <div
                style="display: flex; align-items: center; margin-bottom: 15px"
              >
                <div
                  style="
                    width: 50px;
                    height: 50px;
                    background: #25d366;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 15px;
                  "
                >
                  <span style="font-size: 24px; color: white">📱</span>
                </div>
                <div>
                  <h3 style="margin: 0">WhatsApp Business</h3>
                  <small style="color: #666">Mensajería Automática</small>
                </div>
              </div>
              <p style="color: #666; margin-bottom: 15px">
                Envía recordatorios automáticos y confirmaciones de citas por
                WhatsApp.
              </p>
              <div id="whatsappStatus" style="margin-bottom: 15px">
                <span class="badge" style="background: #d4edda; color: #155724"
                  >Manual Activo</span
                >
              </div>
              <button
                class="btn"
                style="width: 100%; background: #25d366"
                onclick="configureWhatsApp()"
              >
                Automatizar WhatsApp
              </button>
            </div>
          </div>

          <!-- Integration Logs -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            "
          >
            <h3 style="margin-bottom: 20px">Registro de Integraciones</h3>
            <table id="integrationLogsTable">
              <thead>
                <tr>
                  <th>Fecha</th>
                  <th>Integración</th>
                  <th>Acción</th>
                  <th>Estado</th>
                  <th>Detalles</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5" style="text-align: center; color: #666">
                    Aún no hay registros de integración
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Quick Actions -->
          <div
            style="
              background: #f0f9ff;
              padding: 20px;
              border-radius: 8px;
              margin-top: 20px;
            "
          >
            <h3 style="color: #0369a1; margin-bottom: 15px">
              🚀 Acciones Rápidas de Integración
            </h3>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 10px;
              "
            >
              <button
                class="btn"
                style="background: #ff6b35"
                onclick="testSiigoConnection()"
              >
                🧪 Probar Siigo
              </button>
              <button
                class="btn"
                style="background: #0ea5e9"
                onclick="generateRIPS()"
              >
                📄 Generar RIPS
              </button>
              <button
                class="btn"
                style="background: #8b5cf6"
                onclick="syncPatients()"
              >
                🔄 Sincronizar Pacientes
              </button>
              <button
                class="btn"
                style="background: #10b981"
                onclick="viewIntegrationDocs()"
              >
                📖 Ver Documentación
              </button>
            </div>
          </div>
        </div>

        <!-- Notifications Section -->
        <div class="content-section" id="notifications">
          <div class="section-header">
            <h2>Centro de Notificaciones</h2>
            <button class="add-btn" onclick="showNotificationSettings()">
              ⚙️ Configurar
            </button>
          </div>
          <div
            style="
              background: #f0f9ff;
              padding: 20px;
              border-radius: 8px;
              margin-bottom: 20px;
            "
          >
            <h3>Notificaciones Automáticas Activas:</h3>
            <label style="display: block; margin: 10px 0">
              <input type="checkbox" id="emailConfirmation" checked />
              Enviar confirmación de cita por email
            </label>
            <label style="display: block; margin: 10px 0">
              <input type="checkbox" id="emailReminder" checked />
              Enviar recordatorio 24h antes
            </label>
            <label style="display: block; margin: 10px 0">
              <input type="checkbox" id="pushNotifications" checked />
              Enviar notificaciones push a la app
            </label>
            <label style="display: block; margin: 10px 0">
              <input type="checkbox" id="smsNotifications" />
              Enviar SMS (requiere configuración)
            </label>
          </div>
          <h3>Historial de Notificaciones</h3>
          <table id="notificationsTable">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Tipo</th>
                <th>Destinatario</th>
                <th>Mensaje</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="loading">Cargando notificaciones...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- S&OP Section -->
        <div class="content-section" id="sop">
          <div class="section-header">
            <h2>Sales & Operations Planning (S&OP)</h2>
            <div>
              <button
                class="add-btn"
                style="margin-right: 10px; background: #0ea5e9"
                onclick="exportSOPReport()"
              >
                📥 Exportar Informe S&OP
              </button>
              <select
                id="sopPeriod"
                onchange="loadSOPData()"
                style="
                  padding: 10px;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                "
              >
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mes</option>
                <option value="quarter">Este Trimestre</option>
                <option value="year">Este Año</option>
              </select>
            </div>
          </div>

          <!-- KPIs Dashboard -->
          <div class="stats-grid" style="margin-bottom: 30px">
            <div class="stat-card">
              <h3>Demanda Proyectada</h3>
              <div class="value" id="projectedDemand">0</div>
              <small style="color: #666">Citas esperadas</small>
            </div>
            <div class="stat-card">
              <h3>Capacidad Disponible</h3>
              <div class="value" id="availableCapacity">0%</div>
              <small style="color: #666">Utilización actual</small>
            </div>
            <div class="stat-card">
              <h3>Ingresos Proyectados</h3>
              <div class="value" id="projectedRevenue">$0</div>
              <small style="color: #666"
                >vs Real: <span id="actualRevenue">$0</span></small
              >
            </div>
            <div class="stat-card">
              <h3>Eficiencia Operativa</h3>
              <div class="value" id="operationalEfficiency">0%</div>
              <small style="color: #666">Meta: 85%</small>
            </div>
          </div>

          <!-- Demand vs Capacity Chart -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              margin-bottom: 30px;
            "
          >
            <h3 style="margin-bottom: 20px">Análisis Demanda vs Capacidad</h3>
            <canvas id="demandCapacityChart"></canvas>
          </div>

          <!-- Service Mix Analysis -->
          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 20px;
              margin-bottom: 30px;
            "
          >
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <h3 style="margin-bottom: 20px">Mix de Servicios</h3>
              <canvas id="serviceMixChart"></canvas>
            </div>
            <div
              style="
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              "
            >
              <h3 style="margin-bottom: 20px">Proyección de Ingresos</h3>
              <canvas id="revenueProjectionChart"></canvas>
            </div>
          </div>

          <!-- Resource Planning Table -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
              margin-bottom: 30px;
            "
          >
            <h3 style="margin-bottom: 20px">Planificación de Recursos</h3>
            <table id="resourcePlanningTable">
              <thead>
                <tr>
                  <th>Recurso</th>
                  <th>Capacidad Total</th>
                  <th>Utilizado</th>
                  <th>Disponible</th>
                  <th>% Ocupación</th>
                  <th>Proyección</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="loading">Cargando datos...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Alerts and Recommendations -->
          <div
            style="
              background: #fef3c7;
              padding: 20px;
              border-radius: 8px;
              margin-bottom: 30px;
            "
          >
            <h3 style="color: #92400e; margin-bottom: 15px">
              🚨 Alertas y Recomendaciones S&OP
            </h3>
            <div id="sopAlerts">
              <p>• Analizando datos para generar recomendaciones...</p>
            </div>
          </div>

          <!-- Action Plan -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            "
          >
            <h3 style="margin-bottom: 20px">Plan de Acción S&OP</h3>
            <div class="form-group">
              <label>Objetivo de Crecimiento (%)</label>
              <input
                type="number"
                id="growthTarget"
                value="10"
                min="0"
                max="100"
                style="width: 100px; padding: 8px"
              />
              <button
                class="add-btn"
                style="margin-left: 10px"
                onclick="generateActionPlan()"
              >
                Generar Plan
              </button>
            </div>
            <div id="actionPlanResults" style="margin-top: 20px">
              <!-- Action plan will be generated here -->
            </div>
          </div>
        </div>

        <!-- WhatsApp Section -->
        <div class="content-section" id="whatsapp">
          <div class="section-header">
            <h2>📱 Consola de WhatsApp Masivo</h2>
          </div>

          <div
            class="status-bar"
            style="
              display: flex;
              gap: 20px;
              padding: 15px;
              background: #e0f2fe;
              border-radius: 8px;
              margin-bottom: 30px;
            "
          >
            <div
              class="status-item"
              style="display: flex; align-items: center; gap: 8px"
            >
              <div
                style="
                  width: 12px;
                  height: 12px;
                  border-radius: 50%;
                  background: #16a34a;
                "
              ></div>
              <span>WhatsApp Conectado</span>
            </div>
            <div class="status-item">
              <span>Modo: Sandbox Twilio</span>
            </div>
            <div class="status-item">
              <span>Número: +14155238886</span>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px">
            <!-- Panel de envío -->
            <div
              style="
                background: white;
                padding: 30px;
                border-radius: 12px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
              "
            >
              <h3 style="color: #1e3a3f; margin-bottom: 20px">
                💬 Nuevo Mensaje
              </h3>

              <div class="form-group">
                <label>Tipo de envío</label>
                <select id="sendType" onchange="toggleRecipientType()">
                  <option value="single">Individual</option>
                  <option value="group">Grupo específico</option>
                  <option value="all">Todos los pacientes</option>
                  <option value="custom">Números personalizados</option>
                </select>
              </div>

              <div id="singleRecipient" class="form-group">
                <label>Número de WhatsApp</label>
                <input
                  type="tel"
                  id="phoneNumber"
                  placeholder="+57..."
                  value="+573102962552"
                />
                <div style="display: flex; gap: 10px; margin-top: 10px">
                  <button
                    onclick="setPhone('+573102962552')"
                    style="
                      padding: 8px 16px;
                      background: #d1fae5;
                      border: 1px solid #16a34a;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                      color: #16a34a;
                    "
                  >
                    Tu número
                  </button>
                  <button
                    onclick="setPhone('+573023040979')"
                    style="
                      padding: 8px 16px;
                      background: #d1fae5;
                      border: 1px solid #16a34a;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                      color: #16a34a;
                    "
                  >
                    Número prueba
                  </button>
                </div>
              </div>

              <div id="customNumbers" class="form-group" style="display: none">
                <label>Números (uno por línea)</label>
                <textarea
                  id="customNumbersList"
                  placeholder="+573102962552
+573023040979
+57..."
                  style="min-height: 100px"
                ></textarea>
              </div>

              <div id="groupRecipient" class="form-group" style="display: none">
                <label>Seleccionar pacientes</label>
                <div
                  id="patientsList"
                  style="
                    max-height: 200px;
                    overflow-y: auto;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    padding: 10px;
                  "
                >
                  <!-- Se carga dinámicamente -->
                </div>
                <div style="margin-top: 10px">
                  <button
                    class="btn btn-secondary"
                    onclick="selectAllPatients()"
                  >
                    Seleccionar todos
                  </button>
                  <button
                    class="btn btn-secondary"
                    onclick="selectNonePatients()"
                  >
                    Deseleccionar
                  </button>
                </div>
              </div>

              <div class="form-group">
                <label>Plantillas rápidas</label>
                <div style="display: flex; gap: 10px; flex-wrap: wrap">
                  <button
                    onclick="useTemplate('reminder')"
                    style="
                      padding: 8px 16px;
                      background: #e5e7eb;
                      border: 1px solid #d1d5db;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    📅 Recordatorio
                  </button>
                  <button
                    onclick="useTemplate('promo')"
                    style="
                      padding: 8px 16px;
                      background: #e5e7eb;
                      border: 1px solid #d1d5db;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    🎁 Promoción
                  </button>
                  <button
                    onclick="useTemplate('birthday')"
                    style="
                      padding: 8px 16px;
                      background: #e5e7eb;
                      border: 1px solid #d1d5db;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    🎂 Cumpleaños
                  </button>
                  <button
                    onclick="useTemplate('followup')"
                    style="
                      padding: 8px 16px;
                      background: #e5e7eb;
                      border: 1px solid #d1d5db;
                      border-radius: 20px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    👨‍⚕️ Seguimiento
                  </button>
                </div>
              </div>

              <div class="form-group">
                <label>Mensaje</label>
                <textarea
                  id="whatsappMessage"
                  placeholder="Escribe tu mensaje aquí..."
                  style="min-height: 150px"
                >
🌳 *Healing Forest*

¡Hola! 👋

Este es un mensaje de prueba desde la consola administrativa.

_Responde STOP para no recibir más mensajes_</textarea
                >
              </div>

              <button
                class="btn"
                style="
                  background: #25d366;
                  width: 100%;
                  padding: 18px;
                  font-size: 18px;
                "
                onclick="sendWhatsAppMessages()"
              >
                Enviar WhatsApp 🚀
              </button>

              <div
                id="whatsappLoading"
                style="display: none; text-align: center; margin-top: 20px"
              >
                <div
                  style="
                    display: inline-block;
                    width: 50px;
                    height: 50px;
                    border: 5px solid #f3f3f3;
                    border-top: 5px solid #25d366;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                  "
                ></div>
                <p>Enviando mensajes...</p>
              </div>
            </div>

            <!-- Panel de estadísticas -->
            <div>
              <div
                style="
                  background: white;
                  padding: 30px;
                  border-radius: 12px;
                  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                  margin-bottom: 30px;
                "
              >
                <h3 style="color: #1e3a3f; margin-bottom: 20px">
                  📊 Estadísticas de Envío
                </h3>
                <div
                  style="
                    display: grid;
                    grid-template-columns: repeat(2, 1fr);
                    gap: 15px;
                  "
                >
                  <div
                    style="
                      padding: 20px;
                      background: #f9fafb;
                      border-radius: 8px;
                      text-align: center;
                    "
                  >
                    <div
                      style="font-size: 28px; font-weight: bold; color: #16a34a"
                      id="whatsappSent"
                    >
                      0
                    </div>
                    <div
                      style="color: #6b7280; font-size: 14px; margin-top: 5px"
                    >
                      Enviados
                    </div>
                  </div>
                  <div
                    style="
                      padding: 20px;
                      background: #f9fafb;
                      border-radius: 8px;
                      text-align: center;
                    "
                  >
                    <div
                      style="font-size: 28px; font-weight: bold; color: #16a34a"
                      id="whatsappDelivered"
                    >
                      0
                    </div>
                    <div
                      style="color: #6b7280; font-size: 14px; margin-top: 5px"
                    >
                      Entregados
                    </div>
                  </div>
                  <div
                    style="
                      padding: 20px;
                      background: #f9fafb;
                      border-radius: 8px;
                      text-align: center;
                    "
                  >
                    <div
                      style="font-size: 28px; font-weight: bold; color: #dc2626"
                      id="whatsappFailed"
                    >
                      0
                    </div>
                    <div
                      style="color: #6b7280; font-size: 14px; margin-top: 5px"
                    >
                      Fallidos
                    </div>
                  </div>
                  <div
                    style="
                      padding: 20px;
                      background: #f9fafb;
                      border-radius: 8px;
                      text-align: center;
                    "
                  >
                    <div
                      style="font-size: 28px; font-weight: bold; color: #f59e0b"
                      id="whatsappPending"
                    >
                      0
                    </div>
                    <div
                      style="color: #6b7280; font-size: 14px; margin-top: 5px"
                    >
                      Pendientes
                    </div>
                  </div>
                </div>
              </div>

              <div
                style="
                  background: white;
                  padding: 30px;
                  border-radius: 12px;
                  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                "
              >
                <h3 style="color: #1e3a3f; margin-bottom: 20px">
                  📝 Registro de Envíos
                </h3>
                <div
                  id="whatsappLogContainer"
                  style="
                    max-height: 400px;
                    overflow-y: auto;
                    border: 1px solid #e5e7eb;
                    border-radius: 8px;
                    background: #f9fafb;
                  "
                >
                  <!-- Logs dinámicos -->
                </div>
              </div>
            </div>
          </div>

          <div
            style="
              background: #fef3c7;
              padding: 20px;
              border-radius: 8px;
              margin-top: 30px;
            "
          >
            <h4>⚠️ Importante - Configuración WhatsApp:</h4>
            <ol>
              <li>
                Para que funcionen los mensajes, el servidor Node.js debe estar
                corriendo
              </li>
              <li>
                Los destinatarios deben haber enviado "join tu-codigo" al
                +14155238886
              </li>
              <li>
                El sandbox de Twilio expira después de 72 horas de inactividad
              </li>
              <li>
                Para producción, solicita un número WhatsApp Business en Twilio
              </li>
            </ol>
          </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings">
          <div class="section-header">
            <h2>Configuración del Sistema</h2>
          </div>
          <div style="display: grid; gap: 20px">
            <div style="background: white; padding: 20px; border-radius: 8px">
              <h3>Configuración de Email</h3>
              <p>Para activar el envío de emails automáticos:</p>
              <ol>
                <li>
                  Regístrate en
                  <a href="https://www.emailjs.com/" target="_blank">EmailJS</a>
                  (gratis)
                </li>
                <li>Crea un servicio de email</li>
                <li>Obtén tu Service ID, Template ID y Public Key</li>
                <li>
                  Actualiza el archivo <code>email-config.js</code> con tus
                  credenciales
                </li>
              </ol>
            </div>
            <div style="background: white; padding: 20px; border-radius: 8px">
              <h3>Configuración de Pagos (Stripe)</h3>
              <p>Para activar pagos en línea:</p>
              <ol>
                <li>
                  Crea una cuenta en
                  <a href="https://stripe.com" target="_blank">Stripe</a>
                </li>
                <li>Obtén tu API Key</li>
                <li>
                  Configura los webhooks para actualizaciones en tiempo real
                </li>
              </ol>
            </div>
            <div style="background: white; padding: 20px; border-radius: 8px">
              <h3>Notificaciones Push</h3>
              <p>
                Las notificaciones push se envían automáticamente a través de
                Firebase Cloud Messaging (FCM)
              </p>
              <button class="btn" onclick="testPushNotification()">
                Enviar Notificación de Prueba
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Título</h2>
          <button class="close-btn" onclick="closeModal()">&times;</button>
        </div>
        <div id="modalBody">
          <!-- Dynamic content -->
        </div>
      </div>
    </div>

    <!-- Calendar Modal -->
    <div class="modal calendar-modal" id="calendarModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="calendarModalTitle">Calendario de Servicio</h2>
          <button class="close-btn" onclick="closeCalendarModal()">
            &times;
          </button>
        </div>
        <div id="calendarModalBody">
          <!-- Calendar will be loaded here -->
        </div>
      </div>
    </div>

    <script src="logger.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
    <script src="service_capacity.js"></script>
    <script src="service_calendar.js"></script>
    <script src="siigo_integration.js"></script>
    <script src="whatsapp_automation.js"></script>
    <script src="whatsapp_functions.js"></script>
    <script src="ai_predictions.js"></script>
    <script src="patient_sync.js"></script>

    <!-- Librerías -->
    <!-- Chart.js para gráficas: -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- FullCalendar para calendario: -->
    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@5.11.3/main.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jsPDF para generar PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <!-- EmailJS para enviar emails -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- Stripe para pagos -->
    <script src="https://js.stripe.com/v3/"></script>

    <!-- SheetJS para exportar Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Moment.js para manejo de fechas -->
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/latest/locale/es.js"></script>

    <!-- Configuraciones adicionales -->
    <script src="email-config.js"></script>

    <!-- DataTables para tablas avanzadas: -->
    <!-- <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.css"> -->
    <!-- <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.js"></script> -->

    <!-- ApexCharts - COMENTADO POR CAUSAR PROBLEMAS -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/apexcharts@latest"></script> -->
    <!-- <script src="apex_charts_config.js"></script> -->

    <!-- SpinKit Loaders - COMENTADO POR CAUSAR PROBLEMAS -->
    <!-- <script src="spinkit_loaders.js"></script> -->

    <!-- Tabulator - COMENTADO POR CAUSAR PROBLEMAS -->
    <!-- <link
      href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator_materialize.min.css"
      rel="stylesheet"
    /> -->
    <!-- <script
      type="text/javascript"
      src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"
    ></script> -->

    <!-- SheetJS for Excel export -->
    <script
      type="text/javascript"
      src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"
    ></script>

    <!-- jsPDF for PDF export (already included above) -->

    <!-- Tabulator Configuration - COMENTADO POR CAUSAR PROBLEMAS -->
    <!-- <script src="tabulator_config.js"></script> -->
  </body>
</html>
